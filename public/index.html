<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chatran — هوش مصنوعی پیشرفته</title>
<style>
body{margin:0;font-family:tahoma,sans-serif;background:#0b1a2a;color:#e6eef8;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:100vh;}
#app{width:95%;max-width:1200px;margin-top:10px;display:flex;flex-direction:column;flex:1;height:95%;}
#messages{flex:1;overflow-y:auto;padding:10px;background:#082236;border-radius:12px;margin-bottom:8px;}
.msg{margin:4px 0;padding:10px;border-radius:10px;max-width:70%;line-height:1.4;white-space:pre-wrap;}
.user{align-self:flex-end;background:#233243;}
.bot{align-self:flex-start;background:#066b81;}
#inputRow{display:flex;}
#input{flex:1;padding:10px;border-radius:10px;border:none;background:#0b2a3b;color:#e6eef8;font-size:16px;}
#sendBtn{padding:0 20px;margin-left:5px;background:#06b6d4;color:#04282b;border:none;border-radius:10px;cursor:pointer;font-weight:bold;}
</style>
</head>
<body>
<div id="app">
  <div id="messages"></div>
  <div id="inputRow">
    <input id="input" placeholder="پیام خود را بنویسید...">
    <button id="sendBtn">ارسال</button>
  </div>
</div>
<script>
const input = document.getElementById('input');
const sendBtn = document.getElementById('sendBtn');
const messages = document.getElementById('messages');

function addMessage(text,cls){
    const div = document.createElement('div');
    div.className = 'msg ' + cls;
    div.textContent = text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
}

async function sendMessage(){
    const msg = input.value.trim();
    if(!msg) return;
    addMessage(msg,'user');
    input.value='';
    const res = await fetch('/api/message',{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({message:msg})
    });
    const data = await res.json();
    addMessage(data.response,'bot');
}

sendBtn.addEventListener('click',sendMessage);
input.addEventListener('keypress',e=>{if(e.key==='Enter') sendMessage();});
</script>
</body>
</html>
